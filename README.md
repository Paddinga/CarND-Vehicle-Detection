
# Self-Driving Car Engineer Nanodegree


## Project 5: **Vehicle Detection** 

The goals / steps of this project are the following:

* Perform a Histogram of Oriented Gradients (HOG) feature extraction on a labeled training set of images and train a classifier Linear SVM classifier
* Optionally, you can also apply a color transform and append binned color features, as well as histograms of color, to your HOG feature vector. 
* Note: for those first two steps don't forget to normalize your features and randomize a selection for training and testing.
* Implement a sliding-window technique and use your trained classifier to search for vehicles in images.
* Run your pipeline on a video stream (start with the test_video.mp4 and later implement on full project_video.mp4) and create a heat map of recurring detections frame by frame to reject outliers and follow detected vehicles.
* Estimate a bounding box for vehicles detected.

***

### Approach

This project was pretty straight forward due to the preparation in the courses. First I used all of the provided data to classify cars (GTI-Far, GTI-Left, GTI-Right, GTI-Middle-Close and KITTI) and no cars (extra and image) in 64x64 image arrays (pipeline.py line 16). This led to a dataset of 8792 images with cars and 8968 images without cars, and with these numbers to an even number of training data.

The pipeline is split into 2 parts: training the classifier (pipeline.py line 73 including the image features in line 28) and finding cars (pipeline.py line 107) followed by a heatmap (pipeline.py line 158), and explained in the following lines. The pipeline is written in the pipeline.py line 186, additional helper functions are written in the helper.py.

### Training the classifier

The classifier is processed as a Linear SVM Classifier with the following parameters, which were determined on a number of trainings empirically. 

- color space: YCrCb
- HOG orientation: 12
- HOG pixels per cells: 16       
- HOG cells per clock: 2
- used HOG channels: ALL
- spatial binning dimensions: 16 by 16 
- number of histogram bins: 16

The feature list for each of the images is generated by stacking the histogram features, the spatial features and the HOG features, creating a feature list with a length of 2544.

With this configuration the SVM was trained (80% training set and 20% test set) to an accuracy of 99.3% and lasted 3.99 seconds to train. This was the challenge while defining the parameters above. Finding the suiting parameters for a high accuracy by not spending to much time training.

### Finding cars

The code for finding cars is taken from the preparing course lessons. As recommended the HOG features are generated over the whole image and the searching window is sliding through rows and columns of the image. Therefore a region of interest is defined lower than the horizon and above the body of the car. The same features as chosen in the classifier are generated and run through the prediction of the classifier. For each prediction the area is saved into a list. This list is handed to a class for creating and buffering a heatmap. In the first step I used the provided code for adding heat on areas of interest (pipeline.py line 166). These areas are then handed over to a buffering method (pipeline.py line 175). In this buffer the detected areas are saved for 30 frames and added up. With a threshold of 40 then areas of assumed cars are created and marked.

To erase false positives the feature in the cars are take 3 times with different scaling. This did increase the time to process (Â±15 minutes) the video but again set down the number of false positives.

### Result

The result of my pipeline for the project video can be found on [YouTube](https://youtu.be/eiGDrL5fDQk) or in the GitHub repository. 

The cars on the lanes right of the car are detected quite good. But there are still some false positives especially in the area of the guarding rail.

### Discussion

The result is ok, but not satisfying for a use i a real car due to the false positives and the long duration of generating the video. One step to improve the pipeline would be to reduce the feature list and thereby decrease the learning time and increase the accuracy. On the other hand the parameters might not be chosen perfectly. To improve the pipeline a whole number of parameter variants needs to be tested for accuracy and training time.

This project was quite fun, but in the end the code was all over the preparation courses and just the class for using a buffered heatmap was added. Again the project was pretty much about adjusting parameters.




```python

```
